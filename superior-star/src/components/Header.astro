---
import HeaderLink from "./HeaderLink.astro";
import "../styles/header.css";
---

<header>
  
  <div class="header-bg"></div>
  <nav>
    <div class="internal-links">
      <HeaderLink href="/">Portafolio</HeaderLink>
      <HeaderLink href="/blog">Proyectos</HeaderLink>
      <HeaderLink href="/cv">CV</HeaderLink>
    </div>
    <button class="theme-toggle" aria-label="Cambiar tema">
        <svg class="moon-icon" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor">
          <path class="moon" d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke-width="2" />
        </svg>
        <svg class="sun-icon" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor">
          <circle cx="12" cy="12" r="5" stroke-width="2" />
          <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke-width="2" />
        </svg>
    </button>
    <div class="social-links">
      <!-- LinkedIn -->
      <a
        href="https://www.linkedin.com/in/miguel-angel-ledesma-rodriguez-49b8b436b/"
        target="_blank"
        aria-label="LinkedIn"
      >
        <svg viewBox="0 0 24 24" width="32" height="32" fill="currentColor">
          <path
            d="M4.98 3.5C4.98 4.88 3.88 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1 4.98 2.12 4.98 3.5zM0 8h5v16H0V8zm7.5 0h4.7v2.2h.07c.65-1.23 2.23-2.53 4.59-2.53 4.9 0 5.8 3.22 5.8 7.41V24h-5v-6.5c0-1.55-.03-3.55-2.16-3.55-2.16 0-2.49 1.68-2.49 3.42V24h-5V8z"
          ></path>
        </svg>
      </a>

      <a href="https://github.com/MALR07" target="_blank">
        <span class="sr-only">Mi GitHub personal</span>
        <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32"
          ><path
            fill="currentColor"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"
          ></path></svg
        >
      </a>
    </div>
  </nav>
</header>

<script is:inline>
document.addEventListener("DOMContentLoaded", () => {
  const header = document.querySelector("header");
  if (!header) return;

  // Manejo del scroll
  let lastScrollY = window.scrollY;
  const onScroll = () => {
    const y = window.scrollY;
    const threshold = window.innerHeight * 0.05;

    if (y > threshold && y > lastScrollY) {
      header.classList.add("scrolled");
    } else {
      header.classList.remove("scrolled");
    }

    lastScrollY = y;
  };

  window.addEventListener("scroll", onScroll, { passive: true });

  // Manejo del tema oscuro
  const themeToggle = document.querySelector('.theme-toggle');
  
  // Detectar preferencia del sistema
  const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
  
  // Verificar si hay un tema guardado
  const savedTheme = localStorage.getItem('theme');
  if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
    document.documentElement.classList.add('dark-theme');
  }

  themeToggle?.addEventListener('click', () => {
    document.documentElement.classList.toggle('dark-theme');
    
    // Guardar preferencia
    const isDark = document.documentElement.classList.contains('dark-theme');
    localStorage.setItem('theme', isDark ? 'dark' : 'light');
  });
});
</script>
